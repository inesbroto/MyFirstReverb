% Test bench script for: myEchoPlugin.
% Generated by Audio Test Bench on 15-Dec-2024 00:16:30 UTC+01:00.

% Create test bench input and output
fileReader = dsp.AudioFileReader(Filename='/usr/local/MATLAB/R2024a/toolbox/audio/samples/Click-16-44p1-mono-0.2secs.wav');
fileReader = dsp.AudioFileReader(Filename='/home/ibroto/Documents/SMC/Music Perception and Cognition/miniproj/completeClicks.wav');
%fileReader = dsp.AudioFileReader(Filename='/home/ibroto/Downloads/dry-trap-piano-short_145bpm_D#_minor.wav');

fileReader = dsp.AudioFileReader(Filename='/home/ibroto/Downloads/very-sharp-clean-electric-guitar-riff_82bpm_E_major.wav');
%fileReader = dsp.AudioFileReader(Filename='/home/ibroto/Downloads/guitar-riff-disco-riff_121bpm_C_major.wav');


deviceWriter = audioDeviceWriter(SampleRate=fileReader.SampleRate);

% Create the objects under test
sut1 = multipleDelayMixedPlugin;
setSampleRate(sut1,fileReader.SampleRate);

% Stream processing loop
nUnderruns = 0;
while ~isDone(fileReader)
    % Read from input, process, and write to output
    in = fileReader();
    out1 = process(sut1,in);
    nUnderruns = nUnderruns + deviceWriter(out1);
    
    % Uncomment to process callbacks if you are using parameterTuner:
    % drawnow limitrate
end

% Clean up
release(fileReader)
release(deviceWriter)
